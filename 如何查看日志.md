# 为什么没有日志？如何确保日志被记录

## 问题分析

你说重新运行后 logs 目录是空的，这是因为：

### ❌ **只启动服务不会产生日志**

日志只会在以下情况下生成：
1. **真正调用了 DeepSeek LLM**
2. **消息通过了 chat_node 函数**

### ✅ **什么时候会生成日志**

- 通过 Web 界面发送消息给 AI
- 通过 CLI 输入消息并得到 AI 回复
- 每次 DeepSeek API 调用都会生成一条日志

## 测试步骤

### 方法 1: 使用 Web 界面测试

1. **启动后端**:
   ```bash
   venv\Scripts\activate
   uvicorn src.api.main:app --reload --port 8000
   ```

2. **启动前端** (新终端):
   ```bash
   cd frontend
   npm run dev
   ```

3. **打开浏览器访问** `http://localhost:5174`

4. **发送一条消息**，例如 "你好"

5. **等待 AI 回复**

6. **检查日志**:
   ```bash
   python view_logs.py
   ```

### 方法 2: 使用 CLI 测试

1. **激活环境并运行**:
   ```bash
   venv\Scripts\activate
   python -m src.main
   ```

2. **输入一条消息**:
   ```
   User: 你好
   ```

3. **等待回复**

4. **退出** (输入 `quit`)

5. **查看日志**:
   ```bash
   python view_logs.py
   ```

### 方法 3: 快速测试 (已经为你运行过)

```bash
python test_logger.py
python view_logs.py
```

这会创建一条测试日志 (我已经运行过，所以你现在有一条测试记录)

## 如何查看日志

### 查看所有交互记录 (摘要):
```bash
python view_logs.py
```

### 查看完整的交互详情:
```bash
python view_logs.py -i 1
```

### 查看特定日期的日志:
```bash
python view_logs.py -f logs/llm_interactions_20260124.log
```

## 当前状态

✅ 你现在已经有一条测试日志了
- 文件位置: `logs/llm_interactions_20260125.log`
- 运行 `python view_logs.py` 可以看到

## 下一步

1. **启动你的系统** (Web 或 CLI)
2. **发送真实消息给 AI**
3. **等待回复**
4. **运行 `python view_logs.py`** 查看所有交互

## 重要提示

⚠️ **必须收到 AI 回复后才会有日志**

如果发送消息后:
- 没有收到回复
- 出现错误
- API 调用失败

则不会生成完整的交互日志 (但可能有错误日志)

## 查看实时日志

当你运行系统时，控制台会显示:
```
[INFO] Sending 2 messages to DeepSeek for session 550e8400...
[INFO] LLM Call | Session: 550e8400... | Sent: 2 msgs | Received: 157 chars
```

如果你看到这些，说明日志正在记录！
