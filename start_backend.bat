@echo off
REM ================================================================================
REM 仅启动后端 API 服务器（调试模式 - 超详细日志）
REM ================================================================================

echo.
echo ================================================================================
echo 启动后端 API 服务器 (调试模式)
echo ================================================================================
echo.

REM 清理端口 8000
echo [1/2] 清理端口 8000...
for /f "tokens=5" %%a in ('netstat -ano ^| findstr :8000 ^| findstr LISTENING') do (
    echo       杀死进程 %%a
    taskkill /F /PID %%a 2>nul
)
echo      完成
echo.

REM 激活虚拟环境并启动
echo [2/2] 启动服务器...
echo.
echo ================================================================================
echo 服务器地址: http://0.0.0.0:8000
echo 前端连接: http://localhost:8000
echo API 文档: http://localhost:8000/docs
echo ================================================================================
echo.

call venv\Scripts\activate.bat
python run_server_debug.py
